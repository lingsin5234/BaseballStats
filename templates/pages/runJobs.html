{% include 'partials/header.html' %}
    <h1>Run Jobs</h1>

    <form method="post">
        {% csrf_token %}
        <button type="submit" name="extract_2018">Extract 2018</button>
    </form>

    <form method="post">
        {% csrf_token %}
        <button type="submit" name="process_data">Process Data</button>
    </form>

    <script>
        var results = [{"Id": 1, "process_name": "game_lineups", "data_year": 2018, "team_name": "TOR", "time_elapsed": "0.314333200454712", "timestamp": "2020-03-10 12:30:10"}, {"Id": 2, "process_name": "play_processor", "data_year": 2018, "team_name": "TOR", "time_elapsed": "17.8676114082336", "timestamp": "2020-03-10 12:30:28"}, {"Id": 3, "process_name": "game_lineups", "data_year": 2018, "team_name": "TOR", "time_elapsed": "0.422078609466553", "timestamp": "2020-03-10 12:47:31"}, {"Id": 4, "process_name": "play_processor", "data_year": 2018, "team_name": "TOR", "time_elapsed": "18.148782491684", "timestamp": "2020-03-10 12:47:48"}];
        //JSON.parse('{{results|safe}}');
        var columns = ["process_name", "data_year", "team_name", "time_elapsed", "timestamp"];
        var table = d3.select("body").append("table");
        var header = table.append("thead").append("tr");
        header
                .selectAll("th")
                .data(columns)
                .enter()
                .append("th")
                .text(function(c) { return c; });
        var tablebody = table.append("tbody");
        rows = tablebody
                .selectAll("tr")
                .data(results)
                .enter()
                .append("tr");
        // We built the rows using the nested array - now each row has its own array.
        cells = rows.selectAll("td")
            // each row has data associated; we get it and enter it for the cells.
                .data(function(d) {
                    return columns.map(function(c) {
                        return {
                            column: c,
                            value: d[c]
                        };
                    });
                })
                .enter()
                .append("td")
                    .text(function(r) {
                        return r.value;
                    });
    </script>

{% include 'partials/footer.html' %}
