{% include 'partials/header.html' %}
    <h1>Run Jobs</h1>

    <form method="post">
        {% csrf_token %}
        <button type="submit" name="extract_2018">Extract 2018</button>
    </form>

    <form method="post">
        {% csrf_token %}
        <button type="submit" name="process_data">Process Data</button>
    </form>

    <script>
        var results = JSON.parse('{{results|safe}}');
        var columns = ["process_name", "data_year", "team_name", "time_elapsed", "timestamp"];
        var table = d3.select("body").append("table");
        var header = table.append("thead").append("tr");
        header
                .selectAll("th")
                .data(columns)
                .enter()
                .append("th")
                .text(function(c) { return c; });
        var tablebody = table.append("tbody");
        rows = tablebody
                .selectAll("tr")
                .data(results)
                .enter()
                .append("tr");
        // We built the rows using the nested array - now each row has its own array.
        cells = rows.selectAll("td")
            // each row has data associated; we get it and enter it for the cells.
                .data(function(d) {
                    return columns.map(function(c) {
                        return {
                            column: c,
                            value: d[c]
                        };
                    });
                })
                .enter()
                .append("td")
                    .text(function(r) {
                        return r.value;
                    });
    </script>

{% include 'partials/footer.html' %}
